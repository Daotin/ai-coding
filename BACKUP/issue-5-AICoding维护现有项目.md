# AI Coding 维护现有项目

- 编号: #5
- 链接: https://github.com/Daotin/ai-coding/issues/5
- 状态: open
- 创建时间: 2025-10-27
- 更新时间: 2025-10-27
> [!IMPORTANT]
> 核心：根据已有的代码，完善之前没有的文档，包括项目的架构，设计文档，技术栈，各种规范等等，目的是引导 AI 走向正轨！

## 一、前置文档

> “针对中大型项目，在项目架构稳定之后，针对自己项目的结构，让 Gemini 2.5 Pro 生成一个包含项目架构图的 cursor rule，它解释了整个项目的架构，然后在后面添加各种 feature 的时候都可以带着这个 rule，会大大节省和解放时间，让它更了解你的复杂项目，提升 AI 的准确率，是一个我认为到现在为止非常实用的技巧，没有这个 rule 的情况下， 如果没有添加足够上下文的话，AI 经常会胡乱添加很多没用的文件。“

```markdown
请针对当前项目，生成项目架构图，解释整个项目的架构设计，内容输出到 docs/项目架构.mdc 文档，包括但不限于：

- 项目结构规范
- 代码规范
  请分析整个代码库，生成一份项目结构文档，包括：

1. 项目架构概览
2. 主要目录结构及其职责
3. 关键模块的依赖关系图
4. 核心类和接口的功能说明
5. 数据流向图
6. API 接口清单
7. 常见的代码模式和约定
```

要点：Gemini 负责思考，Sonnet 负责构建

- 使用 Gemini 2.5 Pro，生成现存项目的文档 mdc
- 使用 Claude Sonnet 4，按计划构建功能模块，执行具体代码，修复 bug

## 二、新功能+修复 bug

传统的 bug 修复流程：

- 理解需求
- 分析现有代码
- 设计解决方案
- 编写代码
- CR（代码评审+影响评估）
- 测试

比较消耗时间的是：现有代码分析，改动方案，影响评估。

那么，如何使用 AI 来减少这部分时间？

1、现有代码分析

可以从需求的目标改动点开始，梳理其所属功能和实现方式，包含交互流程、数据管理和条件渲染。

| 业务流程                                                                                      | 代码实现                                                           | 字段依赖                                         |
| --------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ | ------------------------------------------------ |
| 提示词：当前功能如何运作，用户交互有哪些路径，具体数据流向是怎样的，请整理成 mermaid 时序图。 | 当前代码如何组织，核心模块有哪些，组件间如何通信，梳理组件关系图。 | 梳理当前表单字段的显隐关系、联动逻辑以及数据源。 |

2、改动方案

```markdown
请根据现有代码分析，逐步分析需求，并告诉我你打算怎么做？仅探讨方案，先不要生成代码。
```

3、代码生成

```markdown
在写代码时遵循最小改动原则，避免影响原先的功能。即使识别到历史问题也不要自行优化，可以先告知我问题描述和对当前需求的影响，不要直接改跟本次需求无关的代码。
```

4、影响评估

```markdown
自测：@git 基于代码变更输出自测用例清单。
CR：@git 逐个文件分析并总结改动点，评估是否对其他模块有影响，或者引入了新的问题。
```

增加 AI 后的流程：

<img width="1000" height="905" alt="Image" src="https://github.com/user-attachments/assets/30f3e9b5-8eb0-4fef-86fb-0ae6a0ac6e56" />

